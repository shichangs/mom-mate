# 回归测试清单

## 睡眠

1. 点击“记录入睡”后生成进行中记录。
2. 点击“记录醒来”后记录进入历史，时长正确，且该条记录身份保持不变（编辑/删除目标不漂移）。
3. “选择其他时间”可选择日期+时间补录，跨天记录展示正确。
4. 重复点击“记录入睡”不会创建多个进行中记录。
5. 编辑记录时，醒来时间不能早于入睡时间。

## 饮食

1. 快速添加可保存记录并立即展示在列表。
2. “食物清单”可统一管理默认与自定义食物（新增、删除、拖拽排序）。
3. “添加饮食记录”中的“常用食物”与食物清单内容及顺序一致。
4. 删除记录后，列表与“今日饮食”摘要计数一致。
5. 餐次筛选结果正确。
6. 食物清单新增同名食材（仅大小写或前后空格不同）时不应重复创建。
7. 旧版本 `savedFoodList` 数据可自动迁移到新食物清单并保持顺序。
8. 选择“水”餐次时可录入毫升数，保存后列表展示正确。

## 成长里程碑

1. 新增、编辑、删除可正常生效。
2. 列表按日期倒序展示。
3. 分类筛选与“全部”切换正确。

## 统计

1. 睡眠统计日/周/月切换正常。
2. 跨夜睡眠记录归属到“醒来当天”。
3. 饮食统计图在有数据/无数据状态都正确显示。
4. 统计页在周/月/年边界切换时不崩溃（无强制解包异常）。
5. 饮食统计中的“每日喝水量（ml）”与记录值一致，日均喝水量计算正确。

## 账号与同步

1. 未登录可直接进入主页面并正常新增/编辑/删除记录（游客模式）。
2. 设置页可进入“账号与同步”页面。
3. Debug 构建下点击“Debug Mock Apple 登录”后显示已登录状态。
4. 登录后重启 App 会话可恢复，退出登录后会话被清除但本机数据仍保留。
5. `cloudSyncEnabled = true` 且已登录时才触发云同步；未登录时不触发云同步。

## 文档

1. 功能行为改动已同步更新 `docs/product/PRD.md`。
2. 功能行为改动已同步更新 `docs/testing/REGRESSION_CHECKLIST.md`。
3. 技术方案改动已同步更新 `docs/architecture/*.md`。
4. PR 描述已注明对应文档与章节。
